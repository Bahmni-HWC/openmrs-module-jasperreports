<?xml version="1.0" encoding="UTF-8"?>

<sqldiff version="1.0">
	<help>
		USE: The diffs are ordered by datamodel version number. The script can be run in a top down fashion and is
		expected to not failor overwrite old data

		EXPECT: - "use business-database-name;" was called prior to calling this script
	</help>

	<diff>
		<version>1.0.0</version>
		<author>Simon Kelly</author>
		<date>Jan 11th 2007</date>
		<desciption>jasper_report and parameterTypeMap tables added</desciption>
		<sql>
			CREATE TABLE IF NOT EXISTS `jasper_report` ( 
			`report_id` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
			`name` VARCHAR(45) NOT NULL DEFAULT '',
			`filename` VARCHAR(50) NOT NULL DEFAULT '', 
			`published` BOOLEAN NOT NULL DEFAULT 0, 
			PRIMARY KEY(`report_id`) 
			) ENGINE = InnoDB DEFAULT CHARSET = utf8;

			CREATE TABLE IF NOT EXISTS `jasper_parameters` (
			`parameter_id` INTEGER UNSIGNED NOT NULL AUTO_INCREMENT,
			`name` VARCHAR(45) NOT NULL DEFAULT '', 
			`class` VARCHAR(50) NOT NULL DEFAULT '', 
			`reportId` INTEGER UNSIGNED	NOT NULL DEFAULT 0, 
			PRIMARY KEY(`parameter_id`), 
			CONSTRAINT `report` FOREIGN KEY `reportId` (`reportId`) REFERENCES `jasper_report` (`report_id`) 
			) ENGINE = InnoDB DEFAULT CHARSET = utf8;
		</sql>
	</diff>

	<diff>
		<version>1.0.1</version>
		<author>Simon Kelly</author>
		<date>Jan 16th 2007</date>
		<desciption>add displayName to jasper_parameters</desciption>
		<sql>
			ALTER TABLE `jasper_parameters` ADD COLUMN `display_name` VARCHAR(45) DEFAULT NULL AFTER `parameter_id`;
		</sql>
	</diff>

	<diff>
		<version>1.0.2</version>
		<author>Simon Kelly</author>
		<date>Jan 22nd 2007</date>
		<desciption>
			add default_value, visible columns to jasper_parameters. add description column to jasper_report
		</desciption>
		<sql>
			ALTER TABLE `jasper_parameters` 
			ADD COLUMN `default_value` VARCHAR(45) DEFAULT NULL AFTER `reportId`,
			ADD COLUMN `visible` TINYINT(1) UNSIGNED NOT NULL DEFAULT 1 AFTER `default_value`,
			ADD COLUMN `dynamic` TINYINT(1) UNSIGNED NOT NULL DEFAULT 0 AFTER `visible`;
			 
			ALTER TABLE `jasper_report` 
			ADD COLUMN `description` TEXT DEFAULT NULL AFTER `name`;
		</sql>
	</diff>
	
	<diff>
		<version>1.0.3</version>
		<author>Simon Kelly</author>
		<date>May 17nd 2007</date>
		<desciption>
			-add mappedClass to jasper_parameters table
			-modify class column default vaule to be null
		</desciption>
		<sql>
			ALTER TABLE `jasper_parameters`
			ADD COLUMN `mapped_class` VARCHAR(50) DEFAULT NULL AFTER `class`;
			
			ALTER TABLE `jasper_parameters`
			MODIFY `class` VARCHAR(50) DEFAULT NULL;
			
			ALTER TABLE `jasper_parameters`
			DROP `dynamic`;			
		</sql>
	</diff>
</sqldiff>